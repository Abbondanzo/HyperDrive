/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var e={11:(e,t,n)=>{var i=n(757),a=n.n(i),r=n(926),o=n.n(r),s=n(575),c=n.n(s),u=(n(682),n(913)),l=n.n(u);const h=new(function(){function e(){c()(this,e),this.listeners={}}return l()(e,[{key:"buildEvent",value:function(e,t){var n=this;return{addEventListener:function(i){return n.addEventListener(e,i,t)},removeEventListener:function(i){return n.removeEventListener(e,i,t)},dispatch:function(t){return n.dispatch(e,t)}}}},{key:"addEventListener",value:function(e,t,n){this.listeners[e]||(this.listeners[e]=[]),this.removeEventListener(e,t,n),this.listeners[e].push({type:e,callback:t,scope:n})}},{key:"removeEventListener",value:function(e,t,n){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter((function(i){var a=i.type,r=i.callback,o=i.scope;return!(e===a&&t===r&&n===o)})))}},{key:"dispatch",value:function(e,t){this.listeners[e]&&this.listeners[e].forEach((function(n){e===n.type&&n.callback.call(n.scope||null,t)}))}},{key:"reset",value:function(){var e=this;Object.keys(this.listeners).forEach((function(t){delete e.listeners[t]}))}}]),e}());var d=h.buildEvent("SONG_MUTE"),f=d.addEventListener,v=(d.removeEventListener,d.dispatch),p=function e(){var t=this;c()(this,e),this.handleClick=function(e){e.stopPropagation(),e.preventDefault(),v({muted:!t.muted})},this.handleSongMute=function(e){var n=e.muted;t.muted=n,t.button.title="Toggle volume",t.button.innerHTML=n?"<i class='fas fa-volume-mute' />":"<i class='fas fa-volume-up' />"},this.button=document.createElement("button"),this.button.id="mute",this.button.addEventListener("click",this.handleClick),this.handleSongMute({muted:!1}),f(this.handleSongMute)},m=h.buildEvent("SONG_PLAY_PAUSE"),y=m.addEventListener,g=(m.removeEventListener,m.dispatch),E=function e(){var t=this;c()(this,e),this.handleClick=function(e){e.stopPropagation(),e.preventDefault(),g({play:!t.play})},this.handleSongPlayPause=function(e){var n=e.play;t.play=n,n?(t.button.innerHTML="<i class='fas fa-pause' />",t.button.title="Pause"):(t.button.innerHTML="<i class='fas fa-play' />",t.button.title="Play")},this.button=document.createElement("button"),this.button.id="play-pause",this.button.addEventListener("click",this.handleClick),this.handleSongPlayPause({play:!0}),y(this.handleSongPlayPause)},w=function(e){var t=document.createElement("div");t.id="controls";var n=new E;t.appendChild(n.button);var i=new p;t.appendChild(i.button),e.appendChild(t)},S=n(212),x=function(){function e(t){c()(this,e),this.loadingManager=new S.lLk,this.container=document.createElement("div"),this.container.id="splash",this.onClickCallback=t,this.container.classList.add("hidden"),this.buildSplash()}return l()(e,[{key:"buildSplash",value:function(){var e=this,t=document.createElement("img");t.src="images/logo_b.png",t.alt="Logo",t.title="HyperDrive",t.onload=function(){e.container.classList.remove("hidden"),e.container.classList.add("fade-in")},this.container.appendChild(t);var n=document.createElement("p"),i=this.isMobile();n.textContent=i?"For the full experience, please open this page on a desktop":"For the best possible experience, please use headphones",this.container.appendChild(n);var a=document.createElement("button");a.innerHTML="Launch",a.addEventListener("click",(function(){e.showLoadingManager(),e.onClickCallback(e.loadingManager,!0)})),this.container.appendChild(a);var r=document.createElement("a");r.innerHTML="Launch Without Sound",r.addEventListener("click",(function(){e.showLoadingManager(),e.onClickCallback(e.loadingManager,!1)}));var o=document.createElement("span");o.appendChild(r),this.container.appendChild(o)}},{key:"showLoadingManager",value:function(){this.container.innerHTML="";var e=document.createElement("h3");e.innerHTML="Loading Scene Assets:",this.container.appendChild(e);var t=document.createElement("p");t.innerHTML="0%",this.container.appendChild(t);var n=function(e,n,i){t.innerHTML="".concat(Math.round(n/i*100),"% <br /> ").concat(e)};this.loadingManager.onStart=n,this.loadingManager.onProgress=n,this.loadingManager.onLoad=function(){t.innerHTML="Building scene... <br />"},this.loadingManager.onError=function(){t.innerHTML="There was an error loading. Please refresh and try again"}}},{key:"isMobile",value:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(window.navigator.userAgent)}}]),e}();x.AUTO_START=!0,n(466);var k=h.buildEvent("FRAME"),P=k.addEventListener,b=k.removeEventListener,L=k.dispatch,M=h.buildEvent("SCREEN_ATTACH"),A=M.addEventListener,_=(M.removeEventListener,M.dispatch),C=h.buildEvent("SONG_FREQUENCY"),T=C.addEventListener,R=(C.removeEventListener,C.dispatch),O=h.buildEvent("SONG_METADATA"),D=O.addEventListener,I=(O.removeEventListener,O.dispatch),F=h.buildEvent("SONG_SKIP"),N=F.addEventListener,U=(F.removeEventListener,F.dispatch),z=h.buildEvent("SONG_SPEED"),j=z.addEventListener,B=(z.removeEventListener,z.dispatch),Z=500,V=16711932,H=function(){function e(){var t=this;c()(this,e),this.setNewBPM=function(n){if(0===t.currentBPM)return t.currentBPM=n,void B({bpm:t.currentBPM});null!==t.bpmTimeout&&clearTimeout(t.bpmTimeout),t.bpmTimeout=window.setTimeout((function(){n>t.currentBPM?(t.currentBPM+=1,B({bpm:t.currentBPM}),t.setNewBPM(n)):n<t.currentBPM&&(t.currentBPM-=1,B({bpm:t.currentBPM}),t.setNewBPM(n))}),e.CHANGE_INTERVAL)},this.handleFrame=function(){null!==t.analyser&&R({averageFrequency:t.analyser.getAverageFrequency(),frequencyData:t.analyser.getFrequencyData()})},this.handlePlayPause=function(e){e.play?t.play():t.pause()},this.handleMute=function(e){var n=e.muted,i=t.getCurrentAudio();n?null==i||i.setVolume(0):i.setVolume(1)},this.handleSkip=function(e){var n=e.direction;"forward"===n?t.playNext():"backward"===n&&t.playPrevious()},this.handleScreenAttach=function(){if(0!==t.songs.length&&null!==t.currentSong){var e=t.songs[t.currentSong];I({song:e})}},this.songs=[],this.currentBPM=0,this.currentSong=null,this.analyser=null,B({bpm:this.currentBPM}),P(this.handleFrame),y(this.handlePlayPause),f(this.handleMute),N(this.handleSkip),A(this.handleScreenAttach)}return l()(e,[{key:"attach",value:function(e){this.songs=e}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.PLAY_ON_START;if(0!==this.songs.length)if(t)this.play();else{g({play:!1});var n=this.getNextSongIndex();this.currentSong=n,this.setNewBPM(this.songs[n].bpm),I({song:this.songs[this.currentSong]})}}},{key:"play",value:function(){0!==this.songs.length&&(null!==this.currentSong?this.isCurrentSongPlaying()||this.startCurrentSong():(this.currentSong=Math.floor(Math.random()*this.songs.length),this.startCurrentSong()))}},{key:"pause",value:function(){var e;null!==this.currentSong&&this.songs.length>0&&(null===(e=this.getCurrentAudio())||void 0===e||e.pause()),this.removeVisualization()}},{key:"stop",value:function(){var e;this.isCurrentSongPlaying()&&(null===(e=this.getCurrentAudio())||void 0===e||e.stop(),this.removeVisualization())}},{key:"removeVisualization",value:function(){this.analyser=null,R({frequencyData:new Uint8Array(1024),averageFrequency:0})}},{key:"playPrevious",value:function(){if(0!==this.songs.length){this.stop();var e=0;null!==this.currentSong&&(e=(this.currentSong-1+this.songs.length)%this.songs.length),this.currentSong=e,this.startCurrentSong()}}},{key:"playNext",value:function(){if(0!==this.songs.length){this.stop();var e=this.getNextSongIndex();this.currentSong=e,this.startCurrentSong()}}},{key:"startCurrentSong",value:function(){var e=this,t=this.songs[this.currentSong];this.setNewBPM(t.bpm),t.audio.play(),this.analyser=new S.kqm(t.audio,2048),g({play:!0}),I({song:t}),t.audio.source.onended=function(){t.audio.isPlaying=!1,e.playNext()}}},{key:"getNextSongIndex",value:function(){return null===this.currentSong?Math.floor(Math.random()*this.songs.length):(this.currentSong+1)%this.songs.length}},{key:"getCurrentAudio",value:function(){return null!==this.currentSong&&this.songs.length>0?this.songs[this.currentSong].audio:null}},{key:"isCurrentSongPlaying",value:function(){var e;return(null===(e=this.getCurrentAudio())||void 0===e?void 0:e.isPlaying)||!1}}]),e}();H.PLAY_ON_START=!0,H.CHANGE_INTERVAL=50;const G=new H;var q=n(564),Q=h.buildEvent("WINDOW_RESIZE"),W=Q.addEventListener,Y=(Q.removeEventListener,Q.dispatch),X=h.buildEvent("LOCKED_MOUSEMOVE"),K=X.addEventListener,J=(X.removeEventListener,X.dispatch),$=n(205),ee=n.n($),te=n(585),ne=n.n(te),ie=n(754),ae=n.n(ie),re=h.buildEvent("LOCKED_MOUSEDOWN"),oe=re.addEventListener,se=(re.removeEventListener,re.dispatch);var ce=function(e){ee()(a,e);var t,n,i=(t=a,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=ae()(t);if(n){var a=ae()(this).constructor;e=Reflect.construct(i,arguments,a)}else e=i.apply(this,arguments);return ne()(this,e)});function a(e,t){var n;return c()(this,a),(n=i.call(this)).onMouseDown=function(e){var t,i;if(!1!==n.isLocked){var a=(null===(t=e.target)||void 0===t?void 0:t.offsetWidth)/2||0,r=(null===(i=e.target)||void 0===i?void 0:i.offsetHeight)/2||0,o=a||e.clientX||-1,s=r||e.clientY||-1;se({x:o,y:s})}},n.onMouseMove=function(e){var t,i;if(!1!==n.isLocked){var r=(null===(t=e.target)||void 0===t?void 0:t.offsetWidth)/2||0,o=(null===(i=e.target)||void 0===i?void 0:i.offsetHeight)/2||0;J({x:r,y:o});var s=e.movementX||e.mozMovementX||e.webkitMovementX||0,c=e.movementY||e.mozMovementY||e.webkitMovementY||0,u=n.euler;u.setFromQuaternion(n.camera.quaternion),u.y-=s*n.horizontalSensitivity,u.x-=c*n.verticalSensitivity,u.x=Math.min(a.PI_2-n.minPolarAngle,u.x),u.x=Math.max(a.PI_2-n.maxPolarAngle,u.x),null!==n.maxRightAngle&&(u.y=Math.max(u.y,n.maxRightAngle)),null!==n.maxLeftAngle&&(u.y=Math.min(u.y,n.maxLeftAngle)),n.camera.quaternion.setFromEuler(u),n.dispatchEvent(a.CHANGE_EVENT)}},n.onPointerlockChange=function(){n.domElement.ownerDocument.pointerLockElement===n.domElement?(n.dispatchEvent(a.LOCK_EVENT),n.isLocked=!0):(n.dispatchEvent(a.UNLOCK_EVENT),n.isLocked=!1)},n.onPointerlockError=function(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")},n.domElement=t,n.isLocked=!1,n.minPolarAngle=0,n.maxPolarAngle=Math.PI,n.maxLeftAngle=Math.PI/2,n.maxRightAngle=-Math.PI/2,n.verticalSensitivity=.0015,n.horizontalSensitivity=.002,n.camera=e,n.euler=new S.USm(0,0,0,"YXZ"),n.vec=new S.Pa4,n.connect(),n}return l()(a,[{key:"connect",value:function(){this.domElement.ownerDocument.addEventListener("mousedown",this.onMouseDown,!1),this.domElement.ownerDocument.addEventListener("mousemove",this.onMouseMove,!1),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange,!1),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError,!1)}},{key:"disconnect",value:function(){this.domElement.ownerDocument.removeEventListener("mousedown",this.onMouseDown,!1),this.domElement.ownerDocument.removeEventListener("mousemove",this.onMouseMove,!1),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange,!1),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError,!1)}},{key:"dispose",value:function(){this.disconnect()}},{key:"getDirection",value:function(){return new S.Pa4(0,0,-1).applyQuaternion(this.camera.quaternion)}},{key:"moveForward",value:function(e){this.vec.setFromMatrixColumn(this.camera.matrix,0),this.vec.crossVectors(this.camera.up,this.vec),this.camera.position.addScaledVector(this.vec,e)}},{key:"moveRight",value:function(e){this.vec.setFromMatrixColumn(this.camera.matrix,0),this.camera.position.addScaledVector(this.vec,e)}},{key:"lock",value:function(){this.domElement.requestPointerLock()}},{key:"unlock",value:function(){this.domElement.ownerDocument.exitPointerLock()}}]),a}(S.pBf);ce.PI_2=Math.PI/2,ce.CHANGE_EVENT={type:"change"},ce.LOCK_EVENT={type:"lock"},ce.UNLOCK_EVENT={type:"unlock"};var ue=function(){function e(){var t=this;c()(this,e),this.updateSize=function(e){var n=e.width,i=e.height;t.camera.aspect=n/i,t.camera.updateProjectionMatrix(),t.cssCamera.aspect=n/i,t.cssCamera.updateProjectionMatrix()},this.updateCSSCamera=function(){t.camera.getWorldQuaternion(t.quaternion),t.cssCamera.setRotationFromQuaternion(t.quaternion),t.raycaster.setFromCamera({x:0,y:0},t.camera)},this.camera=new S.cPb(e.DEFAULT_FOV,1,e.NEAR,e.FAR),this.cssCamera=new S.cPb(e.DEFAULT_FOV,1,e.NEAR,e.FAR),this.cssCamera.position.z=Z,this.quaternion=new S._fP,this.raycaster=new S.iMs,W(this.updateSize),K(this.updateCSSCamera)}return l()(e,[{key:"initializeControls",value:function(e){var t=this;this.controls=new ce(this.camera,e),e.addEventListener("click",(function(){t.controls.isLocked||t.controls.lock()})),this.controls.addEventListener("lock",(function(){console.log("Controls Locked")})),this.controls.addEventListener("unlock",(function(){console.log("Controls Unlocked"),t.updateCSSCamera()}))}}]),e}();ue.DEFAULT_FOV=60,ue.NEAR=.1,ue.FAR=500;const le=new ue,he=new(function(){function e(){c()(this,e),this.handleResize=function(){Y({width:window.innerWidth,height:window.innerHeight})}}return l()(e,[{key:"addListeners",value:function(){window.addEventListener("resize",this.handleResize)}},{key:"removeListeners",value:function(){window.removeEventListener("resize",this.handleResize)}}]),e}());var de=n(50),fe=n(426),ve=n(980),pe=n(776),me=n(684),ye={uniforms:{tDiffuse:{type:"t",value:null},time:{type:"f",value:0},distortion:{type:"f",value:3},distortion2:{type:"f",value:5},speed:{type:"f",value:.2},rollSpeed:{type:"f",value:.1}},fragmentShader:"uniform sampler2D tDiffuse;\nuniform float time;\nuniform float distortion;\nuniform float distortion2;\nuniform float speed;\nuniform float rollSpeed;\n\nvarying vec2 vUv;\n\t\t\n// Start Ashima 2D Simplex Noise\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec2 mod289(vec2 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec3 permute(vec3 x) {\n  return mod289(((x*34.0)+1.0)*x);\n}\n\nfloat snoise(vec2 v) {\n  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0,\n                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0),\n                      -0.577350269189626,  // -1.0 + 2.0 * C.x,\n                      0.024390243902439); // 1.0 / 41.0,\n  vec2 i  = floor(v + dot(v, C.yy) );\n  vec2 x0 = v -   i + dot(i, C.xx);\n\n  vec2 i1;\n  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);\n  vec4 x12 = x0.xyxy + C.xxzz;\n  x12.xy -= i1;\n\n  i = mod289(i); // Avoid truncation effects in permutation\n  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 )) + i.x + vec3(0.0, i1.x, 1.0 ));\n\n  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);\n  m = m*m ;\n  m = m*m ;\n\n  vec3 x = 2.0 * fract(p * C.www) - 1.0;\n  vec3 h = abs(x) - 0.5;\n  vec3 ox = floor(x + 0.5);\n  vec3 a0 = x - ox;\n\n  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );\n\n  vec3 g;\n  g.x  = a0.x  * x0.x  + h.x  * x0.y;\n  g.yz = a0.yz * x12.xz + h.yz * x12.yw;\n  return 130.0 * dot(m, g);\n}\n\n// End Ashima 2D Simplex Noise\n\nvoid main() {\n  vec2 p = vUv;\n  float ty = time*speed;\n  float yt = p.y - ty;\n  //smooth distortion\n  float offset = snoise(vec2(yt*3.0,0.0))*0.2;\n  // boost distortion\n  offset = offset*distortion * offset*distortion * offset;\n  //add fine grain distortion\n  offset += snoise(vec2(yt*50.0,0.0))*distortion2*0.001;\n  //combine distortion on X with roll on Y\n  gl_FragColor = texture2D(tDiffuse, vec2(fract(p.x + offset),fract(p.y-time*rollSpeed) ));\n}\n",vertexShader:"varying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},ge={uniforms:{tDiffuse:{type:"t",value:null},time:{type:"f",value:0},amount:{type:"f",value:.025},size:{type:"f",value:4}},fragmentShader:"uniform sampler2D tDiffuse;\nuniform float time;\nuniform float amount;\nuniform float size;\n\nvarying vec2 vUv;\n\nfloat rand(vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid main() {\n  vec2 p = vUv;\n  vec4 color = texture2D(tDiffuse, p);\n  float xs = floor(gl_FragCoord.x / size);\n  float ys = floor(gl_FragCoord.y / size);\n  vec4 snow = vec4(rand(vec2(xs * time,ys * time))*amount);\n  gl_FragColor = color + snow;\n}\n",vertexShader:"varying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},Ee={uniforms:{tDiffuse:{type:"t",value:null},scanlineCount:{type:"f",value:1200},opacity:{type:"f",value:.1}},fragmentShader:"precision mediump float;\n\nvarying vec2 vUv;\n\nuniform sampler2D tDiffuse;\nuniform float scanlineCount;\nuniform float opacity;\n\nvoid main() {\n  vec2 p = vUv;\n\n  vec4 texel = texture2D(tDiffuse, p);\n  vec3 scanlines = vec2(sin(p.y * scanlineCount), cos(p.y * scanlineCount)).xyx;\n\n  gl_FragColor = vec4(texel.rgb * (1. + scanlines * opacity), 1.0);\n}\n",vertexShader:"varying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"},we=function e(t,n,i){var a=this;c()(this,e),this.handleResize=function(e){var t=e.width,n=e.height;a.composer.setSize(t,n)},this.update=function(e){var t=e.delta,n=e.elapsedTime;a.composer.render(t/1e3),a.badTVPass.uniforms.time.value=n/1e3,a.filmPass.uniforms.time.value=n,a.staticPass.uniforms.time.value=n/1e3},this.handleSongFrequency=function(e){var t=.3*e.averageFrequency/255;a.crtPass.uniforms.opacity.value=.1+t},this.composer=new de.x(i);var r=new fe.C(t,n);this.composer.addPass(r),this.ssaoPass=new pe.G(t,n),this.ssaoPass.output=pe.G.OUTPUT.SSAO,this.filmPass=new ve.T(me.e),this.staticPass=new ve.T(ge),this.staticPass.uniforms.amount.value=.04,this.composer.addPass(this.staticPass),this.badTVPass=new ve.T(ye),this.badTVPass.renderToScreen=!0,this.badTVPass.uniforms.rollSpeed.value=0,this.badTVPass.uniforms.distortion.value=.5,this.badTVPass.uniforms.distortion2.value=.25,this.composer.addPass(this.badTVPass),this.crtPass=new ve.T(Ee),this.composer.addPass(this.crtPass),W(this.handleResize),P(this.update),T(this.handleSongFrequency)},Se=function(){function e(){var t=this;c()(this,e),this.handleResize=function(e){var n=e.width,i=e.height;t.renderer.setSize(n,i),t.cssRenderer.setSize(n,i)},this.update=function(n){n.delta;try{t.cssRenderer.render(t.scene,le.cssCamera),e.USE_COMPOSER||t.renderer.render(t.scene,le.camera)}catch(e){console.warn(e),b(t.update)}},this.scene=new S.xsS,this.scene.add(le.camera),this.renderer=new S.CP7({antialias:!0}),this.cssRenderer=new q.lX,this.composer=new we(this.scene,le.camera,this.renderer),P(this.update),W(this.handleResize)}return l()(e,[{key:"attach",value:function(e){e.appendChild(this.renderer.domElement),this.cssRenderer.domElement.id="css-renderer",e.appendChild(this.cssRenderer.domElement),he.addListeners(),le.initializeControls(e),Y({width:window.innerWidth,height:window.innerHeight})}}]),e}();Se.USE_COMPOSER=!0;const xe=new Se,ke=new(function(){function e(){var t=this;c()(this,e),this.loop=function(e){if(null!==t.lastTime){var n=e-t.lastTime;t.lastTime=e,L({delta:n,elapsedTime:e,frame:t.lastFrame+1}),t.lastFrame=requestAnimationFrame(t.loop)}},this.lastTime=null,this.lastFrame=0}return l()(e,[{key:"play",value:function(){var e=this;this.lastTime||(requestAnimationFrame((function(t){e.lastTime=t})),this.lastFrame=requestAnimationFrame(this.loop))}},{key:"pause",value:function(){this.lastTime=null}}]),e}());var Pe=n(713),be=n.n(Pe),Le=n(319),Me=n.n(Le),Ae=[{name:"Resonance",artist:"Home",bpm:170,durationS:212,filename:"home_resonance.mp3",camelot:"4B",video:"https://youtube.com/watch?v=8GW6sLrK40k"},{name:"Now or Never (You and Me)",artist:"Dan Mason",bpm:88,durationS:286,filename:"dan_mason_now_or_never.mp3",camelot:"4A",video:"https://youtube.com/watch?v=B-DnLyT1pOc"},{name:"Head First",artist:"Home",bpm:134,durationS:213,filename:"home_head_first.mp3",camelot:"4A",video:"https://youtube.com/watch?v=zeiwxt0EP4s"},{name:"22:39",artist:"Danger",bpm:118,durationS:252,filename:"danger_2239.mp3",camelot:"3A",video:"https://youtube.com/watch?v=S7Q7lpA5I9E"},{name:"Over Easy",artist:"Stst",bpm:122,durationS:163,filename:"stst_over_easy.mp3",camelot:"9B",video:"https://www.youtube.com/watch?v=Z6mxU1cMsCo"},{name:"Dynamic",artist:"Voyage",bpm:115,durationS:220,filename:"voyage_dynamic.mp3",camelot:"12A",video:"https://www.youtube.com/watch?v=CTT9nY5S7YU"},{name:"Ether",artist:"Limitless",bpm:95,durationS:229,filename:"limitless_ether.mp3",camelot:"8B",video:"https://www.youtube.com/watch?v=LTXucOshZ_c"},{name:"Eclipse",artist:"Hotel Pools",bpm:170,durationS:221,filename:"hotel_pools_eclipse.mp3",camelot:"10A",video:"https://www.youtube.com/watch?v=rYHNB_lPSNc"}];function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){be()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Te=function(){function e(t){var n=this;c()(this,e),this.name="Songs",this.getRandomSongToLoad=function(){var e=Math.floor(Math.random()*Ae.length);return Ae[e]},this.loadAllSongsInBackground=function(){var e=o()(a().mark((function e(t,i){var r,o,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ae.filter((function(e){return e.name!==i.name})),e.next=3,Promise.all(r.map((function(e){return n.loadSong(t,e)})));case 3:o=e.sent,s=[i].concat(Me()(o)),G.attach(s);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.camera=t}var t,n;return l()(e,[{key:"load",value:(n=o()(a().mark((function t(n){var i,r,o,s=this;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.listener=new S.SJI,i=new S.mTL(n),r=this.getRandomSongToLoad(),t.next=5,this.loadSong(i,r);case 5:o=t.sent,G.attach([o]),setTimeout((function(){return s.loadAllSongsInBackground(i,o)}),e.LOAD_REMAINDER_DELAY);case 8:case"end":return t.stop()}}),t,this)}))),function(e){return n.apply(this,arguments)})},{key:"attach",value:function(){this.camera.add(this.listener)}},{key:"loadSong",value:(t=o()(a().mark((function e(t,n){var i=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.loadAsync("songs/".concat(n.filename)).then((function(e){var t=new S.BbS(i.listener);return t.setBuffer(e),t.setLoop(!1),t.duration&&(n.durationS=t.duration),Ce(Ce({},n),{},{audio:t})})));case 1:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})}]),e}();Te.LOAD_REMAINDER_DELAY=3e3;var Re=function(){function e(){c()(this,e),this.name="Sky Box"}var t;return l()(e,[{key:"load",value:(t=o()(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.cubeTexture=new S.cBK(t).setPath("textures/cubemap/").load(["px.png","nx.png","py.png","black.png","black.png","nz.png"]),this.fog=new S.ybr(1118481,1,200);case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"attach",value:function(e){e.background=this.cubeTexture,e.fog=this.fog}}]),e}(),Oe=n(47),De=function(e,t){return new Promise((function(n,i){new Oe.E(e).load(t,(function(e){var t=new S.ZAu;t.add.apply(t,Me()(e.scene.children)),n(t)}),void 0,(function(e){i(e)}))}))},Ie=function(){function e(){var t=this;c()(this,e),this.onSkipBackwardClick=function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),U({direction:"backward"})},this.onPlayPauseClick=function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),g({play:!t.playing})},this.onSkipForwardClick=function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),U({direction:"forward"})},this.handleLockedMousedown=function(e){var n=e.x,i=e.y;t.isInBounds(n,i,t.playPause)?t.onPlayPauseClick():t.isInBounds(n,i,t.back)?t.onSkipBackwardClick():t.isInBounds(n,i,t.forward)&&t.onSkipForwardClick()},this.handleSongPlayPause=function(e){var n=e.play;t.playing=n,n?(t.playPause.innerHTML="<i class='fas fa-pause' />",t.playPause.title="Pause"):(t.playPause.innerHTML="<i class='fas fa-play' />",t.playPause.title="Play")},this.div=document.createElement("div"),this.div.id="song-controls",this.back=document.createElement("button"),this.playPause=document.createElement("button"),this.forward=document.createElement("button"),this.handleSongPlayPause({play:!1}),this.setPlayControls(),oe(this.handleLockedMousedown),y(this.handleSongPlayPause)}return l()(e,[{key:"setPlayControls",value:function(){this.back.innerHTML="<i class='fas fa-backward' />",this.back.addEventListener("click",this.onSkipBackwardClick),this.div.appendChild(this.back),this.playPause.addEventListener("click",this.onPlayPauseClick),this.playPause.id="song-playpause",this.div.appendChild(this.playPause),this.forward.innerHTML="<i class='fas fa-forward' />",this.forward.addEventListener("click",this.onSkipForwardClick),this.div.appendChild(this.forward)}},{key:"isInBounds",value:function(e,t,n){var i=n.getBoundingClientRect(),a=i.top,r=i.bottom,o=i.left,s=i.right;return e>=o&&e<=s&&t>=a&&t<=r}}]),e}(),Fe=function(){function e(){var t=this;c()(this,e),this.showNameDiff=function(n){var i=n.offsetWidth-n.parentElement.offsetWidth;i<=0||(n.style.transform="translateX(-".concat(i+8,"px)"),t.songNameOffset=window.setTimeout((function(){return t.hideNameDiff(n)}),e.NAME_SCROLL_OFFSET_MS))},this.hideNameDiff=function(n){n.style.transform="translateX(0px)",t.songNameOffset=window.setTimeout((function(){return t.showNameDiff(n)}),e.NAME_SCROLL_OFFSET_MS)},this.handleSongMetadata=function(e){var n=e.song;t.setSongInfo(n.artist,n.name)},this.div=document.createElement("div"),this.div.id="song-metadata",this.setSongInfo("No Artist","No Song Name"),D(this.handleSongMetadata)}return l()(e,[{key:"setSongInfo",value:function(e,t){this.div.innerHTML="";var n=document.createElement("span");n.id="song-artist",n.innerHTML=e,this.div.appendChild(n);var i=document.createElement("span");i.id="song-name",i.innerHTML=t,this.div.appendChild(i),this.checkSongNameOffset(i)}},{key:"checkSongNameOffset",value:function(e){clearTimeout(this.songNameOffset),this.showNameDiff(e)}}]),e}();Fe.NAME_SCROLL_OFFSET_MS=8e3;var Ne=function(){function e(){var t=this;c()(this,e),this.handleSongSpeed=function(e){var n=e.bpm;t.assignSpeed(n)},this.div=document.createElement("div"),this.div.id="speedometer",j(this.handleSongSpeed)}return l()(e,[{key:"assignSpeed",value:function(e){this.div.innerHTML="";var t=document.createElement("span");t.innerHTML="Speed",this.div.appendChild(t);var n=document.createElement("div"),i=document.createElement("span");i.id="speed",i.innerHTML="".concat(e),n.appendChild(i);var a=document.createElement("span");a.innerHTML=" bpm",n.appendChild(a),this.div.appendChild(n)}}]),e}(),Ue=function(){function e(){var t=this;c()(this,e),this.checkScreenIntersect=function(){null!==t.intersectObject&&(le.raycaster.intersectObject(t.intersectObject).length>0?t.lockPointer.classList.remove("hidden"):t.lockPointer.classList.add("hidden"))},this.div=document.createElement("div"),this.div.id="screen",this.intersectObject=null,this.lockPointer=document.createElement("div"),this.lockPointer.id="lockpointer",this.lockPointer.classList.add("hidden"),document.body.appendChild(this.lockPointer),this.speedometer=new Ne,this.div.appendChild(this.speedometer.div),this.appendDivider(),this.metadata=new Fe,this.div.appendChild(this.metadata.div),this.controls=new Ie,this.div.appendChild(this.controls.div),_({screen:this.div}),K(this.checkScreenIntersect)}return l()(e,[{key:"setIntersect",value:function(e){this.intersectObject=e}},{key:"appendDivider",value:function(){var e=document.createElement("hr");e.className="divider",this.div.appendChild(e)}}]),e}(),ze={defines:{BIN_SIZE:1024,N_BANDS:16},uniforms:{frequencies:{type:"t",value:new Float32Array(1024)}},fragmentShader:"varying float sV;\nvarying vec2 vUv;\n\nvec3 yellow = vec3(0.988, 0.804, 0.020);\nvec3 purple = vec3(1.000, 0.000, 0.988);\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord) {\n  vec3 col = vec3(0.0);\n  vec2 pct = vUv * 2.0;\n\n  float nBands = float(N_BANDS);\n  float idx = floor(vUv.x * nBands);\n  float band = idx / nBands;\n  band = band * band;\n\n  float f = fract(vUv.x * nBands);\n  \n  // More purple as sV approaches 0\n  vec3 gradient = mix(yellow, purple, sV);\n\n  col += vec3(1.0 - step(0.0, pct.y - sV * 1.5));\n  col *= gradient;\n  \n  // Simulate spacing\n  col *= step(0.05, f);\n  col *= step(f, 0.95);\n\n  col = clamp(col, 0.0, 1.0);\n\n  if (length(col) <= 0.05) {\n    fragColor = vec4(0.0);\n  } else {\n\t  fragColor = vec4(col, 1.0);\n  }\n }\n\n\nvoid main() {\n  mainImage(gl_FragColor, gl_FragCoord.xy);\n}\n",vertexShader:"uniform sampler2D frequencies;\n\nconst int lod = 0;\n\nvarying float sV;\nvarying vec2 vUv;\n\nvoid main() {\n  // We only care about the first 18k hz, in a full 24k\n  float fft = float(BIN_SIZE) * 0.75;\n  int xIdx = int(uv.x * fft);\n  // Grab a frequency value and set the range 0.0 to 1.0\n  sV = texelFetch(frequencies, ivec2(xIdx, 0), lod).x / 255.;\n  // Pass UV for pct calculations\n  vUv = uv;\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"};function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){be()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ze=function(){function e(){var t=this;c()(this,e),this.name="SongVisualizer",this.handleSongFrequency=function(e){var n=e.frequencyData;if(t.material){var i=t.toDataTexture(n);t.material.uniforms.frequencies.value=i}},T(this.handleSongFrequency)}var t;return l()(e,[{key:"load",value:(t=o()(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new S._12(.15,.15,32),this.material=new S.jyz(Be(Be({},ze),{},{transparent:!0})),this.mesh=new S.Kj0(t,this.material),this.mesh.position.set(0,.375,-.4);case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"attach",value:function(e){e.add(this.mesh)}},{key:"setRotation",value:function(e){this.mesh.setRotationFromAxisAngle(new S.Pa4(1,0,0),e)}},{key:"toDataTexture",value:function(e){var t=new Float32Array(e);return new S.IEO(t,1024,1,S.hEm,S.VzW)}}]),e}(),Ve=function(){function e(){c()(this,e),this.name="Screen",this.screenDOM=new Ue,this.visualizer=new Ze}var t;return l()(e,[{key:"load",value:(t=o()(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.object=new S.Tme,t=new q.cp(this.screenDOM.div),this.object.add(t),e.next=5,this.visualizer.load();case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"attach",value:function(e){this.copyWorldPosition(e,this.object),this.object.updateWorldMatrix(!1,!0),this.screenDOM.setIntersect(e),e.add(this.object),this.visualizer.attach(e),this.visualizer.setRotation(this.getXRotation(e))}},{key:"copyWorldPosition",value:function(e,t){var n=new S.Pa4(.685,-.49,-.1).multiplyScalar(Z);t.position.set(n.x,n.y,n.z);var i=this.getXRotation(e);t.rotateX(i),this.applyScale(e),t.updateMatrix()}},{key:"applyScale",value:function(e){var t=e.geometry.boundingBox,n=t.max,i=t.min,a=Math.abs(n.x-i.x),r=Math.abs(n.y-i.y);this.screenDOM.div.style.width="".concat(2*a*Z,"px"),this.screenDOM.div.style.height="".concat(2.35*r*Z,"px")}},{key:"getXRotation",value:function(e){var t=e.geometry.boundingBox,n=t.max,i=t.min,a=1.21*Math.abs(n.x-i.x),r=Math.abs(n.y-i.y);return-Math.atan(a/r)}}]),e}();function He(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Ge=function(){function e(t){c()(this,e),this.name="Car",this.camera=t,this.screen=new Ve}var t;return l()(e,[{key:"load",value:(t=o()(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De(t,"models/chassis.gltf");case 2:return this.chassis=e.sent,e.next=5,this.screen.load();case 5:this.applyOffset(this.chassis),this.chassis.castShadow=!0,this.chassis.receiveShadow=!0,"chassis",n=this.screen,window.chassis=n;case 9:case"end":return e.stop()}var n}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"attach",value:function(t){var n=this.getScreenMesh(this.chassis);this.screen.attach(n);var i=new S.ZAu;i.name=e.GROUP_NAME,i.add(this.chassis),i.add(this.camera),i.add(this.getPointLight()),t.add(i)}},{key:"applyOffset",value:function(e){e.position.x=.345,e.position.y=-.7,e.position.z=-.1}},{key:"getScreenMesh",value:function(e){var t=e.children.find((function(e){return"Screen"===e.name}));if(t)return t;var n,i=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return He(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?He(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw r}}}}(e.children);try{for(i.s();!(n=i.n()).done;){var a=n.value,r=this.getScreenMesh(a);if(r)return r}}catch(e){i.e(e)}finally{i.f()}return null}},{key:"getPointLight",value:function(){var e=new S.cek(V,.2);return this.applyOffset(e),e.position.y=.1,e.lookAt(0,-3,-3),e}}]),e}();Ge.GROUP_NAME="CAR_CAMERA_GROUP";var qe=function(){function e(){var t=this;c()(this,e),this.name="Cube",this.handleFrame=function(){t.cube&&(t.cube.rotation.x+=.005,t.cube.rotation.y+=.005)},P(this.handleFrame)}var t;return l()(e,[{key:"load",value:(t=o()(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=new S.DvJ,n=new S.xoR({color:65280,opacity:0,transparent:!0}),this.cube=new S.Kj0(t,n);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"attach",value:function(e){this.cube.position.z-=5,e.add(this.cube)}}]),e}(),Qe=function(){function e(){var t=this;c()(this,e),this.name="Environment Lighting",this.handleSongFrequency=function(e){var n=.1*e.averageFrequency/255;t.ambientLight.intensity=.1+n,t.hemisphereLight.intensity=.1+n},T(this.handleSongFrequency)}var t;return l()(e,[{key:"load",value:(t=o()(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.ambientLight=new S.Mig(16777215,.1),this.pointLight=new S.cek(16777215,.1),this.pointLight.position.set(1,2,3),this.hemisphereLight=new S.vmT(16567557,V,.1),this.hemisphereLight.position.set(0,50,0);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"attach",value:function(e){e.add(this.ambientLight),e.add(this.hemisphereLight)}}]),e}(),We=function(){function e(){var t=this;c()(this,e),this.name="Mountains",this.handleFrame=function(){t.assignRandomDiffs()},P(this.handleFrame)}var t;return l()(e,[{key:"load",value:(t=o()(a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.geometry=new S._12(160,80,20,10),n=new S.YBo({color:0}),this.zDiffs=Array(this.geometry.vertices.length).fill(0),this.plane=new S.Kj0(this.geometry,n),this.plane.rotateX(-Math.PI/4),this.plane.position.set(0,-20,-e.Z_DISTANCE);case 6:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"attach",value:function(e){e.add(this.plane)}},{key:"assignRandomDiffs",value:function(){for(var e=0;e<this.zDiffs.length;e++){var t=this.zDiffs[e];t<.01&&t>-.01?this.zDiffs[e]=20*Math.random()+10-this.geometry.vertices[e].z:(this.zDiffs[e]=.985*t,this.geometry.vertices[e].z+=.015*t)}this.geometry.verticesNeedUpdate=!0,this.geometry.normalsNeedUpdate=!0}}]),e}();We.Z_DISTANCE=400;var Ye=function e(){var t=this;c()(this,e),this.handleSongSpeed=function(n){var i=n.bpm/e.MS_PER_MINUTE*t.offsetMultiplier;t.offsetPerMS=i},this.offsetMultiplier=1,this.offsetPerMS=0,j(this.handleSongSpeed)};Ye.MS_PER_MINUTE=6e4;var Xe=function(e){ee()(s,e);var t,n,i,r=(n=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ae()(n);if(i){var a=ae()(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return ne()(this,e)});function s(){var e;return c()(this,s),(e=r.call(this)).name="Pavement",e.handleFrame=function(t){var n=t.delta,i=(e.texture.offset.x+n*e.offsetPerMS)%1;e.texture.offset.x=i},e.height=s.SQUARE_SIZE,e.width=e.height+s.DISTANCE,e.offsetMultiplier=s.OFFSET_MULTIPLIER,P(e.handleFrame),e}return l()(s,[{key:"load",value:(t=o()(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new S.dpR(t).loadAsync("textures/road/pavement.png");case 2:this.texture=e.sent,this.texture.wrapS=S.rpg,this.texture.repeat.set(this.width/this.height,1),this.texture.anisotropy=16,n=new S.xoR({map:this.texture,shininess:0}),i=new S._12(this.width,this.height,32),this.plane=new S.Kj0(i,n),this.plane.rotation.x=-s.NINTETY_DEGREES,this.plane.rotation.z=s.NINTETY_DEGREES;case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"attach",value:function(e){e.add(this.plane)}}]),s}(Ye);Xe.SQUARE_SIZE=10,Xe.OFFSET_MULTIPLIER=2,Xe.NINTETY_DEGREES=Math.PI/2,Xe.DISTANCE=600;var Ke=function(e){ee()(s,e);var t,n,i,r=(n=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ae()(n);if(i){var a=ae()(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return ne()(this,e)});function s(){var e;return c()(this,s),(e=r.call(this)).name="Lamps",e.handleFrame=function(t){var n=t.delta,i=s.GAP_DISTANCE*e.offsetPerMS,a=(e.lampsGroup.position.z+n*i)%s.GAP_DISTANCE;e.lampsGroup.position.z=a},e.offsetMultiplier=Xe.SQUARE_SIZE/s.GAP_DISTANCE*Xe.OFFSET_MULTIPLIER,P(e.handleFrame),e}return l()(s,[{key:"load",value:(t=o()(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De(t,"models/lamp.gltf");case 2:this.lampModel=e.sent;case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"attach",value:function(e){var t=this.buildSide(!0),n=this.buildSide(!1);this.lampsGroup=new S.ZAu,this.lampsGroup.add(t,n),e.add(this.lampsGroup)}},{key:"buildSide",value:function(e){for(var t=new S.ZAu,n=-s.TOTAL_DISTANCE;n<=s.GAP_DISTANCE;n+=s.GAP_DISTANCE){var i=this.lampModel.clone(!0);i.scale.x*=e?-1:1,this.addLightToLamp(i),i.position.z=n,t.add(i)}return t.position.x=e?-4:4,t}},{key:"addLightToLamp",value:function(e){var t=new S.PMe(16777181);t.intensity=2,t.penumbra=.5;var n=(new S.ZzF).setFromObject(e),i=n.min.x,a=n.max.y,r=(n.max.z+n.min.z)/2;t.position.set(i,a,r),t.lookAt(i,0,r),e.add(t),e.add(t.target)}}]),s}(Ye);Ke.GAP_DISTANCE=80,Ke.TOTAL_DISTANCE=200;var Je=function(e){ee()(s,e);var t,n,i,r=(n=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ae()(n);if(i){var a=ae()(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return ne()(this,e)});function s(){var e;return c()(this,s),(e=r.call(this)).name="Buildings",e.handleFrame=function(t){for(var n=t.delta,i=Ke.GAP_DISTANCE*e.offsetPerMS*n,a=e.leftInstance.position.z+i;a>e.lastZOffset+4*s.FULL_SQUARE_SIZE;){var r=1+Math.floor(e.lastZOffset/s.Z_DISTANCE),o=e.lastZOffset%s.Z_DISTANCE/s.FULL_SQUARE_SIZE;e.computeRow(o,r),e.lastZOffset+=s.FULL_SQUARE_SIZE}s.ROTATE_O&&e.computeRotateO(),e.leftInstance.position.z=a,e.rightInstance.position.z=a},e.length=Math.floor(s.Z_DISTANCE/s.FULL_SQUARE_SIZE),e.width=s.MAX_WIDTH_SQUARES,e.instanceCount=e.length*e.width,e.lastZOffset=0,e.offsetMultiplier=Xe.SQUARE_SIZE/Ke.GAP_DISTANCE*Xe.OFFSET_MULTIPLIER,P(e.handleFrame),e}return l()(s,[{key:"load",value:(t=o()(a().mark((function e(t){var n,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new S.dpR(t).loadAsync("textures/skyscraper/basic.jpg");case 2:for((n=e.sent).wrapS=S.rpg,n.wrapT=S.rpg,n.anisotropy=16,n.repeat.set(1,2),this.leftInstance=this.buildingMesh(n),this.leftInstance.position.x=3*-Xe.SQUARE_SIZE,this.rightInstance=this.buildingMesh(n),this.rightInstance.position.x=3*Xe.SQUARE_SIZE,i=0;i<this.length;i++)this.computeRow(i,0);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"buildingMesh",value:function(e){var t=s.SQUARE_SIZE,n=s.SQUARE_SIZE*s.VERTICAL_SCALE,i=new S.nvb(t,n,t),a=new S.vBJ({map:e});return new S.SPe(i,a,this.instanceCount).instanceMatrix.setUsage(S.dj0),new S.SPe(i,a,this.instanceCount)}},{key:"computeRow",value:function(e,t){for(var n=new S.yGw,i=0;i<this.width;i++){var a=s.FULL_SQUARE_SIZE/2;a*=i+1===this.width?2:1;var r=t*s.Z_DISTANCE,o=a+s.FULL_SQUARE_SIZE*i,c=s.FULL_SQUARE_SIZE/-4*(this.width-i);c-=2.5*Math.random()*s.FULL_SQUARE_SIZE-a;var u=a+s.FULL_SQUARE_SIZE*e+r,l=e*this.width+i;this.leftInstance.setMatrixAt(l,n.setPosition(new S.Pa4(-o,c,-u))),this.rightInstance.setMatrixAt(l,n.setPosition(new S.Pa4(o,c,-u)))}this.leftInstance.instanceMatrix.needsUpdate=!0,this.rightInstance.instanceMatrix.needsUpdate=!0}},{key:"attach",value:function(e){e.add(this.leftInstance,this.rightInstance)}},{key:"computeRotateO",value:function(){for(var e=this.lastZOffset%s.Z_DISTANCE/s.FULL_SQUARE_SIZE,t=(this.lastZOffset+4*s.FULL_SQUARE_SIZE-this.leftInstance.position.z)/s.FULL_SQUARE_SIZE,n=1/s.ROTATE_AFFECTED_ROWS,i=0;i<this.length;i++){var a=(e+i)%this.length,r=0;if(this.length-i<=s.ROTATE_AFFECTED_ROWS){var o=s.ROTATE_AFFECTED_ROWS-(this.length-i);r=Math.min(o*n+t*n,1)*s.ROTATE_MIN}this.applyRowRotation(this.leftInstance,a,r),this.applyRowRotation(this.rightInstance,a,-r)}}},{key:"applyRowRotation",value:function(e,t,n){for(var i=new S.Pa4,a=new S._fP,r=new S.Pa4,o=0;o<this.width;o++){var s=t*this.width+o,c=new S.yGw;e.getMatrixAt(s,c),c.decompose(i,a,r);var u=i.y;i.y=0,a.setFromAxisAngle(new S.Pa4(0,0,1),n),c=(c=c.compose(i,a,r)).setPosition(i.x,u,i.z),e.setMatrixAt(s,c)}e.instanceMatrix.needsUpdate=!0}}]),s}(Ye);Je.Z_DISTANCE=480,Je.MAX_WIDTH_SQUARES=3,Je.SQUARE_SIZE=12,Je.FULL_SQUARE_SIZE=16,Je.VERTICAL_SCALE=8,Je.ROTATE_O=!0,Je.ROTATE_AFFECTED_ROWS=15,Je.ROTATE_MIN=Math.PI/3;var $e=function(){function e(){c()(this,e),this.name="Road",this.subjects=[new Ke,new Xe,new Je],this.group=new S.ZAu,this.group.name="Road"}var t;return l()(e,[{key:"load",value:(t=o()(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.group.position.x=.69,this.group.position.y=-1.5,e.next=4,Promise.all(this.subjects.map((function(e){return e.load(t)})));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"attach",value:function(e){var t=this;this.subjects.forEach((function(e){e.attach(t.group)})),e.add(this.group)}}]),e}(),et=function(){var e=o()(a().mark((function e(t,n){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[new Te(le.camera),new Re,new Ge(le.camera),new qe,new Qe,new We,new $e],e.prev=1,e.next=4,Promise.all(i.map((function(e){return tt(e.name,(function(){return e.load(n)}))})));case 4:e.sent,e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(1),console.error(e.t0),e.abrupt("return",!1);case 12:return i.forEach((function(e){return e.attach(t)})),e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),tt=function(e,t){var n=function(){return[e,performance.now()-i]},i=performance.now();return t().then(n,n)},nt=function(){var e=o()(a().mark((function e(t,n){var i,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=document.getElementById("splash-container"),r=document.getElementById("canvas-container"),xe.attach(r),e.next=5,et(xe.scene,t);case 5:if(e.sent){e.next=9;break}return a=i,o=void 0,(o=document.createElement("p")).style.textAlign="center",o.innerHTML="There was an error loading. Please refresh and try again",a.innerHTML="",a.appendChild(o),e.abrupt("return");case 9:w(r),i.classList.add("hidden"),r.classList.add("fade-in"),r.classList.remove("hidden"),G.start(n),ke.play();case 16:case"end":return e.stop()}var a,o}),e)})));return function(t,n){return e.apply(this,arguments)}}();document.addEventListener("DOMContentLoaded",(function(){var e,t;e=document.getElementById("splash-container"),t=new x(nt),e.appendChild(t.container)}))}},t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={exports:{}};return e[i].call(a.exports,a,a.exports,n),a.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0},t=[[11,937]],i=()=>{};function a(){for(var i,a=0;a<t.length;a++){for(var r=t[a],o=!0,s=1;s<r.length;s++){var c=r[s];0!==e[c]&&(o=!1)}o&&(t.splice(a--,1),i=n(n.s=r[0]))}return 0===t.length&&(n.x(),n.x=()=>{}),i}n.x=()=>{n.x=()=>{},o=o.slice();for(var e=0;e<o.length;e++)r(o[e]);return(i=a)()};var r=a=>{for(var r,o,[c,u,l,h]=a,d=0,f=[];d<c.length;d++)o=c[d],n.o(e,o)&&e[o]&&f.push(e[o][0]),e[o]=0;for(r in u)n.o(u,r)&&(n.m[r]=u[r]);for(l&&l(n),s(a);f.length;)f.shift()();return h&&t.push.apply(t,h),i()},o=this.webpackChunkhyperdrive=this.webpackChunkhyperdrive||[],s=o.push.bind(o);o.push=r})(),n.x()})();
//# sourceMappingURL=../maps/static/js/main.js.map